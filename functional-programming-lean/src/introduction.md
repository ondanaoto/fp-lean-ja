Lean（リーン）は、依存型理論に基づいて開発されたMicrosoft Researchによる対話型の定理証明器です。
依存型理論とは、プログラムと証明の世界を統合するものです。従って、Leanはプログラミング言語としても機能します。
Leanはこの二重性を重視しており、汎用プログラミング言語として使用するのに適した設計となっています。Leanは自分自身でさえその中で実装されています。
この書籍は、Leanでのプログラミングに焦点を当てています。

プログラミング言語としてのLeanは、厳格な純粋関数型言語であり、依存型を持っています。
Leanを用いたプログラミング学習の大きな部分は、これらの特性がプログラムの書き方に与える影響を学び、関数型プログラマーの思考方法を理解することです。
_厳格さ_ は、Leanにおける関数呼び出しが、多くの言語と同様に動くことを意味します：引数は関数の本体が実行される前に完全に計算されます。
_純粋さ_ とは、Leanのプログラムが、たとえばメモリの位置を変更したり、メールを送信したり、ファイルを削除するような副作用を持たないことを指します。プログラムの型がそう言わない限り、それは不可能です。
Leanが _関数型_ 言語であるというのは、関数が他の任意の値と同じように一級の値であるということであり、実行モデルが数学的表現評価に刺激を受けていることを意味します。
_依存型_ は、Leanの最も独特な特徴であり、型を言語の一級市民とし、プログラムを含めた型を扱うこと、またはプログラムによる型計算を可能にします。

この書籍は、これまで関数型プログラム言語を使った経験がなくても、Leanを学びたいと願うプログラマーのために用意されています。
Haskell、OCaml、F#のような関数型言語に精通している必要はありませんが、ループや関数、データ構造など、ほとんどのプログラミング言語で共通の概念についての知識を仮定しています。
この書籍は関数型プログラミングへの良い導入書であることを意図していますが、プログラミング一般についての入門書としては適していません。

数学者の中には、Leanを証明アシスタントとして使用し、いずれカスタム証明自動化ツールの作成が必要になる人もいます。
この書籍はそうした目的にも役立ちます。
これらのツールは関数型言語内のプログラムに類似して洗練されていきますが、多くの実践数学者はPythonやMathematicaのような言語に慣れています。
この書籍はその知識のギャップを埋めるのに役立ち、より多くの数学者に持続可能でわかりやすい証明自動化ツールの作成能力を提供することができます。

この書籍は前から順に読むことを意図しています。
コンセプトは一つずつ紹介され、後のセクションでは前のセクションに詳しいことが前提とされています。
時には、早期の章で簡単に扱われたトピックが後の章で深掘りされることがあります。
いくつかのセクションには演習問題が含まれており、それらをこなすことでセクションの内容を固めることができます。
また、本を読みながらLeanを探求し、学んだことを新しい方法で適用することも有益です。

# Leanをはじめよう

Leanでプログラムを書いて実行する前に、Leanをご自身のコンピューターにセットアップする必要があります。
Leanツールキットは以下を含みます：

 * `elan` は、`rustup`や`ghcup`と同様に、Leanコンパイラツールチェーンを管理します。
 * `lake` は、`cargo`、`make`、Gradleに似て、Leanパッケージとその依存関係をビルドします。
 * `lean` は、個々のLeanファイルの型チェックとコンパイルを行います。また、プログラマーツールに現在書いているファイルについて情報を提供します。
   通常、`lean`は直接ユーザーによって呼ばれるのではなく、他のツールによって呼ばれます。
 * Visual Studio CodeやEmacsなどのエディタプラグインは、`lean`と通信して便利な情報を表示します。

Leanのインストールに関する最新の説明は、[Leanマニュアル](https://leanprover.github.io/lean4/doc/quickstart.html)を参照してください。

# 約物の規約

Leanに入力されるコードの例は以下のようにフォーマットされます：
```lean
{{#example_decl Examples/Intro.lean add1}}

{{#example_in Examples/Intro.lean add1_7}}
```
上記の例の最後の行（`#eval`で始まる行）は、Leanに答えの計算を命令するコマンドです。
Leanの返答は以下のようにフォーマットされます：
```output info
{{#example_out Examples/Intro.lean add1_7}}
```
Leanが返すエラーメッセージは以下のようにフォーマットされます：
```output error
{{#example_out Examples/Intro.lean add1_string}}
```
警告は、以下のようにフォーマットされます：
```output warning
declaration uses 'sorry'
```

# ユニコード

慣用的なLeanコードには、ASCIIには含まれない様々なUnicode文字が使用されます。
たとえば、この本の第1章ではギリシャ文字の `α` や `β`、矢印 `→` が登場します。
これにより、Leanコードは標準的な数学的表記法に近づきます。

デフォルトのLeanの設定では、Visual Studio CodeとEmacsの両方でこれらの文字をバックスラッシュ (`\`) に続けて名前を入力することでタイプできます。
例えば、`α` を入力するには、`\alpha` とタイプします。
Visual Studio Codeで文字の入力方法を知りたい場合は、マウスでその文字を指し、ツールチップを見てください。
Emacsでは、対象の文字の上で `C-c C-k` を使用します。